from api_auto_test.uaf_api_test.Config import config

db = config.conf[ 'mysql' ][ 'database' ]  # 获取业务库名
# 厂商设备型号黑名单用例初始化sql语句l
test_black_list = {
    # 1、创建厂商：HUAWEI
    "sql": "INSERT INTO t_vendor(ven_id, vendor_name, vendor_alias) VALUES ('1', 'HUAWEI','华为')",
    # 2、添加设备型号
    "sql2": "INSERT INTO t_equipment(equ_id, ven_id, equ_model, status, createts) VALUES "
            "(2, 1, 'HUAWEI-MATE40', 1, '2022-06-14 10:15:48')",
    # 3、设备加入黑名单
    "sql3": "INSERT INTO t_equipment_forbid(ea_id, equ_id, ven_id, tenant_id, equ_version_id) "
            "VALUES (3, 2, 1, '1103', NULL)",
    # 4、删除设备黑名单
    "sql4": "delete from t_equipment_forbid where ea_id='3'",
    # 5、删除设备型号
    "sql5": "delete from t_equipment where equ_id='2'",
    # 6、删除创建的厂商
    "sql6": "delete from t_vendor where ven_id='1'"
}
# 厂商不在白名单用例初始化sql语句
test_white_list = {
    # #1、创建厂商：VIVO
    "sql": "INSERT INTO t_vendor(ven_id, vendor_name, vendor_alias) VALUES ('11', 'VIVO','vivo')",
    # 2、厂商VIVO加入白名单
    "sql2": "INSERT INTO t_vendor_allow(vf_id, ven_id, tenant_id, equ_id, equ_version_id) VALUES "
            "('12', '11', '1103', NULL, NULL)",
    # 3、把厂商VIVO从白名单移除
    "sql3": "delete from t_vendor_allow where vf_id='12'",
    # 4、删除创建的厂商
    "sql4": "delete from t_vendor where ven_id='11'"
}

# 数据库初始化添加配置
initialization = {
    # 元数据添加、指纹、证书---9999、FFF3
    "fido_metadata": "INSERT INTO %s.t_auth_metadata(metadata_id, aaid, auth_version, description, json_data, status, createts, updatets, auth_type, protocol) VALUES ('1', '004A#9999', 1, 'test UAF1.0 AUTHENTICATOR', '{\"authenticatorVersion\":1,\"tcDisplayPNGCharacteristics\":[{\"filter\":0,\"bitDepth\":16,\"width\":320,\"interlace\":0,\"compression\":0,\"colorType\":2,\"height\":240}],\"tcDisplay\":1,\"icon\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAASCAYAAAD7T5b+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVZSURBVEhLrVdbT1tHEPaPa7kYG/AN3+8Xrqa0UBUoTXlCAoW3oAYJpY0CtoMJLdgIFwhQeCGNWypEGl6oyEMopEAb8ZCIi6f7jc/6hqlaykjDOWd39vN+M7Ozg6op1Ehup4ucDge5bqgel5sCPj81BkPk83h4DHjA9Xm9FPQHKBQI8nw5xbzL7lTwnIwX8l9vDwUebFl5rZOcdgfPqcymBlpcWKRoNErRWExRvJdTOZ+3iT+epPsjI2Q3Wxh0aHCI4vE4xWAjMLs/62ZypZuSis3Bsd9OT+ewRwSezWalxsBVezjPYbOT3WqlR+PjFIlGWCfjk5SYnRXjNlLZLFZaW/2BbkMMOj1tbGwoX3npaO8gv9d3ZYNQjIdbw4plXuaSSd6gtAN5aK1GSxOPxhWrYoHzQJrTT1+vo7aWVopORCiRSFAykRSKp9Sk8EKCpqee0I/PnjHA5eVl0RPSYDTRyvKq8pWXj8LtufQsVYy3NrcolnmZm0uSVURf2iFFa6rVtPPyJc9nMhm6uLjg94PfD3gONrBVgX1zYxMPeN0eQuSy4bWx4h1j0IoPPqStrS0GYjIZfmXp7e6l+to6Wl1ZUUbychNSSREpkML+fCKa+jodvf3rLc9dZi7p4jxL6JfNTaqqqCzCVOGPDC1Ufhca4YcNRiOdnp4yEASekoJN4aBaGsy0/HRZGc3LjUgl5piU2+Uht8ediwqceX5+zu/IHESoFJNJlVMQ4+gJUJfTySCQwnTDOyqVVyjW3CappaUl0qhrqOuTTmWk2JGDg4McPRyfUsxrSUHdDhe1tBT/oCT1/t17MptM5BMpKyN7m6SCwSANDg0pX1lCkhQKj92SLSKlWQW9Qkoa4dD39vQwCKQQ9OjoiGq1WvJ7iivabZB6J5zlEXfdVHyKvwsz4/j4mOzijPM9VoaM1LKkTAYjDQ8PK1BZkTn96/Y2aWs0nJqlwLdB6s+TE4FjodR8ir/l+YHs7e2RUTgbBa0cltQcKWwQWis2HIvEGAReKoxQKpUirbgnCgHkWuQ2Dvby0/9Y/bzl088jzvLIvXvKV3HEwm1tuTus1LHQHClsCiV7fX2dF0oiMkIPv3nIB7McCBTjVhGp1eUsKbke8k+kgmK8ublZscxvfnFhgQvFnS/6+LtUBgYG+H4tWyiwGaRSZUUF7e7+xgsQchklyPDdu2TUG64AyMtORgp3WWp+ntcUkgq3tlHAL0iVaXtwBwVDQcUyvw5tFqLhEsXK5/PxGCQj9iUd/USUdHWVmn+/0NncUWjVGjo8PGDD0gh93NFBurp6UQmzDSOaRzzRkqCU49DK8+XzeKm/v5/XFaZLZ2cnuVzl+z9cF319+WjI3+//8g7jAdcvnojKyfEJz0Gk3faLF6SurM7hwV5lNZspnU6zAQwLN7Ozs0Ojo6MUE41pZGKCopFIkcaiMRr96j4TtJjMDIiqmU7/pCBk5ezsjPzC2ziv0vtoSLngBAJFxQCyufkz6XS6IvJwHC7a9PPnilUWF3L0xxGnqkxxlcFgoFevXvHk/5HvRbVCSwViSFX0iqWyv79PMzMzNC66azwP37xRZvIyO/Md1WvrGEcSku94ajUaGhsbU6yLM8ImChUqoyokjPV6PX394AHNitadm9mkaGL/paLxRJ+2trbGTTE8CjWLH7Db7fRY/GtycJBN7etk//U+R91iMfO1ICMjSeVUkGoSfapZZFd7e1jUgF0FIS99n/dlqx88gBSCpx1KI3sTLd0Ivl3i/OFMqququT/8tKuLenp7qauzi38T43oxjznYYy9SC7Gk8rgoOLgKkBHVlVXc0Er1uNz0N8/ohTCg6ZarAAAAAElFTkSuQmCC\",\"description\":\"test UAF1.0 AUTHENTICATOR\",\"attestationTypes\":[15879],\"imagePngContentType\":\"image/png\",\"keyProtection\":6,\"tcDisplayContentType\":\"text/plain\",\"authenticationAlgorithm\":2,\"aaid\":\"004A#9999\",\"userVerificationDetails\":[[{\"userVerification\":2}]],\"attachmentHint\":1,\"attestationRootCertificates\":[\"gz3IhVR7Onksl1mT2tAWFZaM1NIasoO7zLZU7tv4Xk6ipLZ260b9hjqU8JtPAIzsd9CeJZ93CeCbok3VCjC7Aw==*ESUuQEaXs2f3xD3VEIM5f9xyBJrL7EmBccRAJZdrlVH0OUoN5LkQp1Q9WgmdiGFlPkP6YO2p+9DjrPvJ73/ON+Jg5LeXITZ024Xa+OnblVeWYKPOr0vKLCE687g+27kM24Xa+OnblVcWHkV4AugyKAaV6iRL2yef0aAQzY9HthYNj1xe4UZLUnujmTk5mdySuTyXDU3TZYr7PQZMACzrHZhrQMEL161oRUdpvzqrqXxhEIgZnIDkXb17+7hEOHd9dIISpOh/F7MttRBrJlzfEHtxo6dr3vwk3YSXgmAupSw4W8/In3EabD3MAvltvBu0844jNi0QveWOZJapaxdBH9rahaPH1mGH/0mcRXC3Kt6Mwvy05X40bVXvbY1Pa/YTgi25vfeNp2wOb6Kf+ntYhLeC7e4UhRorgi25vfeNp2yNt4HUUDU8icLMN1Bf8kNSstrM6I2CMQIHeDQhgLjT0PTP4lTb2shv2ilzwaIWCMLOBIi14UJ9n3STExV0bg07v5v5I1p7cJsqeBm/Ste49OMsMq5CwcfvBwV9VDjyb+susOMC+JOKFYFJSwydgmXcCEegiDXgl2qWlYRDnvLhQkLZQjuAMNvk005X49EtcUFuWUtcBh4zlveIlLamnZwWmRRzks6H1kGJxGNDw5cYTDKHIsY4CFmfTfPvj751z8Liq3LI6QauE+zguG+kfGvmI4qHiRg6BVhU2VRZGQpoylBmLbjztooAaqiT7pd56aQEqHVP3pF3CqedJ89psxOfXS/Vh62ybZo3DTTC2X2wxYMMhhvi+GhMZTcBKwmiEO/XNxSElHwx9Hd1NjZMbA7ikEZzd6/dVTmGwUlPbPfyvD/8/zrD3INYCOwremckgxvEZJnF7gKt6PgYLGLCx3EyDEbMUyqQDJCFk92zgNbi5D6ZIkSLCRu8XHbeFKhrcCZ/h0xiuq4Gk0GAA6iCAtzzhOvfL3Ge762PLtznnLeGFONpETCO9kiiVGlWZyVnfYCG7AgZ5gpbITX3Lj5GLY6bpjNsG8IQLUqdinc6YAN36yNmoI1l6+YZ3RiVCsCdlN4=\"],\"isSecondFactorOnly\":false,\"publicKeyAlgAndEncoding\":256,\"assertionScheme\":\"UAFV1TLV\",\"upv\":[{\"major\":1,\"minor\":0}],\"matcherProtection\":2}', 1, '2022-06-27 02:13:49', NULL, '00', 'uaf')" % db,
    "cert_metadata": "INSERT INTO %s.t_auth_metadata(metadata_id, aaid, auth_version, description, json_data, status, createts, updatets, auth_type, protocol) VALUES ('2', '004A#FFF3', 1, 'UAP FIDO CERT FINGER TEE AUTHENTICATOR(SM2)', '{\"authenticatorVersion\":1,\"secureLevel\":2,\"tcDisplayPNGCharacteristics\":[{\"filter\":0,\"bitDepth\":16,\"width\":320,\"interlace\":0,\"compression\":0,\"height\":240,\"colorType\":2}],\"tcDisplay\":4,\"icon\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAASCAYAAAD7T5b+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVZSURBVEhLrVdbT1tHEPaPa7kYG/AN3+8Xrqa0UBUoTXlCAoW3oAYJpY0CtoMJLdgIFwhQeCGNWypEGl6oyEMopEAb8ZCIi6f7jc/6hqlaykjDOWd39vN+M7Ozg6op1Ehup4ucDge5bqgel5sCPj81BkPk83h4DHjA9Xm9FPQHKBQI8nw5xbzL7lTwnIwX8l9vDwUebFl5rZOcdgfPqcymBlpcWKRoNErRWExRvJdTOZ+3iT+epPsjI2Q3Wxh0aHCI4vE4xWAjMLs/62ZypZuSis3Bsd9OT+ewRwSezWalxsBVezjPYbOT3WqlR+PjFIlGWCfjk5SYnRXjNlLZLFZaW/2BbkMMOj1tbGwoX3npaO8gv9d3ZYNQjIdbw4plXuaSSd6gtAN5aK1GSxOPxhWrYoHzQJrTT1+vo7aWVopORCiRSFAykRSKp9Sk8EKCpqee0I/PnjHA5eVl0RPSYDTRyvKq8pWXj8LtufQsVYy3NrcolnmZm0uSVURf2iFFa6rVtPPyJc9nMhm6uLjg94PfD3gONrBVgX1zYxMPeN0eQuSy4bWx4h1j0IoPPqStrS0GYjIZfmXp7e6l+to6Wl1ZUUbychNSSREpkML+fCKa+jodvf3rLc9dZi7p4jxL6JfNTaqqqCzCVOGPDC1Ufhca4YcNRiOdnp4yEASekoJN4aBaGsy0/HRZGc3LjUgl5piU2+Uht8ediwqceX5+zu/IHESoFJNJlVMQ4+gJUJfTySCQwnTDOyqVVyjW3CappaUl0qhrqOuTTmWk2JGDg4McPRyfUsxrSUHdDhe1tBT/oCT1/t17MptM5BMpKyN7m6SCwSANDg0pX1lCkhQKj92SLSKlWQW9Qkoa4dD39vQwCKQQ9OjoiGq1WvJ7iivabZB6J5zlEXfdVHyKvwsz4/j4mOzijPM9VoaM1LKkTAYjDQ8PK1BZkTn96/Y2aWs0nJqlwLdB6s+TE4FjodR8ir/l+YHs7e2RUTgbBa0cltQcKWwQWis2HIvEGAReKoxQKpUirbgnCgHkWuQ2Dvby0/9Y/bzl088jzvLIvXvKV3HEwm1tuTus1LHQHClsCiV7fX2dF0oiMkIPv3nIB7McCBTjVhGp1eUsKbke8k+kgmK8ublZscxvfnFhgQvFnS/6+LtUBgYG+H4tWyiwGaRSZUUF7e7+xgsQchklyPDdu2TUG64AyMtORgp3WWp+ntcUkgq3tlHAL0iVaXtwBwVDQcUyvw5tFqLhEsXK5/PxGCQj9iUd/USUdHWVmn+/0NncUWjVGjo8PGDD0gh93NFBurp6UQmzDSOaRzzRkqCU49DK8+XzeKm/v5/XFaZLZ2cnuVzl+z9cF319+WjI3+//8g7jAdcvnojKyfEJz0Gk3faLF6SurM7hwV5lNZspnU6zAQwLN7Ozs0Ojo6MUE41pZGKCopFIkcaiMRr96j4TtJjMDIiqmU7/pCBk5ezsjPzC2ziv0vtoSLngBAJFxQCyufkz6XS6IvJwHC7a9PPnilUWF3L0xxGnqkxxlcFgoFevXvHk/5HvRbVCSwViSFX0iqWyv79PMzMzNC66azwP37xRZvIyO/Md1WvrGEcSku94ajUaGhsbU6yLM8ImChUqoyokjPV6PX394AHNitadm9mkaGL/paLxRJ+2trbGTTE8CjWLH7Db7fRY/GtycJBN7etk//U+R91iMfO1ICMjSeVUkGoSfapZZFd7e1jUgF0FIS99n/dlqx88gBSCpx1KI3sTLd0Ivl3i/OFMqququT/8tKuLenp7qauzi38T43oxjznYYy9SC7Gk8rgoOLgKkBHVlVXc0Er1uNz0N8/ohTCg6ZarAAAAAElFTkSuQmCC\",\"description\":\"UAP FIDO CERT FINGER TEE AUTHENTICATOR(SM2)\",\"attestationTypes\":[15879],\"keyProtection\":6,\"tcDisplayContentType\":\"text/plain\",\"authenticationAlgorithm\":7,\"aaid\":\"004A#FFF3\",\"userVerificationDetails\":[[{\"userVerification\":2}]],\"attestationRootCertificates\":[\"FA3FjQHmmzfJto8/0y8AIEA96yuD7PmaEKWyDZKXnAfm2qrAtE7du41AD1YKoC30rjImwzt84kCAA8xrCBAVyQ==*Y6Mo6LTu1G+HegfA/4Vxw3usrYWDnaXnIUyCF8x76SkRqJP7aP0tI9/3jmuZAGhS80PUJHijFIooX5w5GYzJo0Jd5borMPgUDhyd+uWrr0aJ9g3DIS0vhXMJ0dfQzJzWLaC4ndvKO/+a/S9aVy89qciGrAPNPGBm6HPUnInr2bGG7c5Of9dpFVEGyYRbNnVEmgonlC4zPjnVq8iKCcNKXpRWUiD+zYaumwsBKDZe2ovWQIh6J19Bnz0UC6J5nMm2NkMlJP9B9Ie9GrqhzqlBEEtcUZJmUFlIW0ZxlA5c9cGljo7XjiAS04W0wy0VbdBY/PTOiRguiBnvhE8gnSMpcGGm9httJwiJlx7ptz+ez5ZV4UiPnvnHExWdm2rwzqZCA2d+1/smJw7NOE6XzoDnZvIPxu+oxuioL9YEtTifeZqAoGRW+CXXUU70ZLGElg+wwy5pR+0IfjbHDwS8XpAPtYz5NdVjIrK7nh25xKHZrZ8FKpPKdP0YBAJ7Hdc6cccP1Zb1HOweMfeRNxg2SL0Emyhl0XhOGtKkuaoVAMdljiE1XaogaGUX5wS8Vx3YF1xtb8fmt/9l8QwUNNzseGeyew85QuKRbHGT6uQYzizdP3rnly5bbnpup/uubFtZbJLT12uSuZ3o+rshTIIXzHvpKb85COY/9oY6yj7sgCyhxOvHZeNTIOEHtwpqaouT5AtGadjAMgKc8gxjw8XLnIK/5NXfnVwzmX4yvwIDXSITHDF0kGySEcVuUPCESpCa+/TQUrXeMJtGtyzyoy7NeleFSyFGbHkNMfRtng3Fax1sJBg=\"],\"attachmentHint\":1,\"isSecondFactorOnly\":false,\"publicKeyAlgAndEncoding\":256,\"assertionScheme\":\"UAFV1TLV\",\"upv\":[{\"major\":1,\"minor\":0}],\"matcherProtection\":2}', 1, '2022-06-26 04:15:49', NULL, '20', 'uaf')" % db,
    # 策略配置：指纹-登录、证书指纹-登录
    "fido_login": "INSERT INTO %s.t_policy(pl_id, policy_name, auth_type, trans_type, tenant_id, createts) VALUES ('3', 'POLICY_1103_00_00', '00', '00', '1103', '2022-04-08 02:39:51')" % db,
    "cert_login": "INSERT INTO %s.t_policy(pl_id, policy_name, auth_type, trans_type, tenant_id, createts) VALUES ('4', 'POLICY_1103_20_00', '20', '00', '1103', '2022-04-08 02:39:56')" % db,
    # 应用管理：添加应用
    "android": "INSERT INTO %s.t_facets(facet_id, facet_name, facet_type, auth_code, createts, updatets, tenant_id) VALUES ('5', 'android:apk-key-hash:qhuAUk3jKIeoGs0HHbpsu0oCOg0', 'android', 'gb/m2shGRVz6fPLCwNeURFDPJRPgmd4NGGuLaEcsy9IKIo1jrbQUg5SCflKmQ7YsjnCaQOlELECBFQ WyBNfSWw==*I48H0koQu1f8uLiqGv2HHH9WP/ZO0OC9ybAku3nz9J+cPUBR92oYonnaj60rTdto3N aMox/lSNI=', '2022-06-26 09:28:07', NULL, '1103')" % db,
    "ios": "INSERT INTO %s.t_facets(facet_id, facet_name, facet_type, auth_code, createts, updatets, tenant_id) VALUES ('6', 'ios:bundle-id:com.gmrz.ios.FaceProve', 'ios', 'htQBPxZfHENNiijizSkEe3QypeO8SuhsOF1mo+p+JgzGv/O2Ls9NvJzv5QTqjrZJPzhkjhgVVqO5bdzYo7J9og==*nu8tmvbyv3I9CT90JqbMta0PFJkucmGGJR2t4nQVCfsodphRBlH5Bw==', '2022-06-26 04:19:00', NULL, '1103')" % db,
    "web": "INSERT INTO %s.t_facets(facet_id, facet_name, facet_type, auth_code, createts, updatets, tenant_id) VALUES ('7', 'com.noknok.android.sampleapp', 'web', 'gsk3IALuHYFk23AVJP8th7xqYlS2NWIwuMF8lzQel7xYoKg6/QtA7HxOGO4cfIDCOeLGvzdMMq/CXmODERNjbg==*nvIGkywq9DUYT7PVMn67wbeBYLuArryfz8YCwtxq0j0=', '2022-06-26 04:19:22', NULL, '1103')" % db,
    # 数字证书
    "ca_port": "INSERT INTO {}.t_plugin_argument(pa_id, sp_id, config_cname, config_value, des, createts, updatets, order_number, tenant_id) VALUES ('8',(SELECT sp_id from {}.t_service_plugin WHERE aaid='certifica') , 'ca.port', '8445', 'ca.port', '2022-06-26 04:20:00', NULL, 1, '1103')".format(
        db, db),
    "sign_host": "INSERT INTO {}.t_plugin_argument(pa_id, sp_id, config_cname, config_value, des, createts, updatets, order_number, tenant_id) VALUES ('9', (SELECT sp_id from {}.t_service_plugin WHERE aaid='certifica'), 'sign.host', '110.61.32.34', '验签', '2022-06-26 04:20:21', NULL, 1, '1103')".format(
        db, db),
    "ca_host": "INSERT INTO {}.t_plugin_argument(pa_id, sp_id, config_cname, config_value, des, createts, updatets, order_number, tenant_id) VALUES ('10', (SELECT sp_id from {}.t_service_plugin WHERE aaid='certifica'), 'ca.host', '192.168.6.153', 'ca.host', '2022-06-26 04:19:45', NULL, 1, '1103')".format(
        db, db),
    "max_num": "INSERT INTO {}.t_plugin_argument(pa_id, sp_id, config_cname, config_value, des, createts, updatets, order_number, tenant_id) VALUES ('11', (SELECT sp_id from {}.t_service_plugin WHERE aaid='certifica'), 'device.max.num', '5000', 'device.max.num', '2022-06-26 04:20:36', NULL, 1, '1103')".format(
        db, db),
    # 证书授权
    "cert_dict": "INSERT INTO {}.t_dict(dict_id, dt_id, dict_name, dict_text, is_enable, order_number, data1, data2, des) VALUES ('12', (SELECT dt_id from {}.t_dict_type WHERE dt_name = '数字证书'), 'certNo', 'eyJjb2RlIjoiQ21hNzIrTDA3bC85aWVoaEZCZGxFbW8xZWFMR2o2OWdqL0llcE45WTczMmNGMnFIU1FPbzRTeThRUHNpL2IwOTJLQ01vdUR6ZlZ5WHBpQWYyTmNMVXc9PSIsImluZm8iOnsiYyI6ImZpZG8iLCJzIjoxMDAwMDAwMDAwLCJ0IjoxMDAwMDAwMDAwLCJrIjoxMDAwMDAwMDAwfX0=', '1', 1, NULL, NULL, NULL)".format(
        db, db)
}
